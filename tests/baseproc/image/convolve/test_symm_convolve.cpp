//==============================================================================
//
//    OPENROX   : File test_symm_convolve.cpp
//
//    Contents  : Tests for symm_convolve.c
//
//    Author(s) : R&D department directed by Ezio MALIS
//
//    Copyright : 2022 Robocortex S.A.S.
//
//    License   : LGPL v3 or commercial license
//
//==============================================================================

//=== INCLUDED HEADERS   =======================================================

#include <openrox_tests.hpp>

extern "C"
{
   #include <baseproc/maths/kernels/gaussian2d.h>
	 #include <baseproc/image/convolve/array2d_float_symmetric_separable_convolve.h>
   #include <baseproc/image/convolve/array2d_uchar_symmetric_separable_convolve.h>
   #include <baseproc/array/error/l2_error.h>
   #include <inout/numeric/array2d_print.h>
   #include <inout/system/print.h>
}

//=== INTERNAL MACROS    =======================================================

ROX_TEST_SUITE_BEGIN(symm_convolve)

#define IMG_REF_PATH ROX_DATA_HOME"/regression_tests/openrox/plane/image_plane3D000.pgm"

Rox_Float Ir_data[24*32] = {   87,   228,    94,    29,    16,   228,    42,   239,   207,   172,     7,   233,   137,   105,   236,   143,    88,   244,   129,    85,   236,    77,   171,   115,   226,    22,   157,   178,   171,   217,    62,    19,
                            75,   204,    95,   201,    81,   180,   194,   117,   191,   183,   108,   205,   226,   154,   197,   197,   239,     9,   125,    39,   205,   240,    53,    53,   184,    42,   209,   109,   128,   234,   148,   101,
                           191,   188,   175,    75,   198,   142,   223,    62,    31,   164,    47,   191,   230,   192,    11,    80,    32,    92,   224,    89,    73,   251,   167,   230,     5,    83,   226,   214,    56,   252,   222,     1,
                             3,    14,   153,   154,   178,    48,    90,   195,   134,   107,   186,   208,   160,   149,    97,    46,   187,   169,    91,    32,   139,    74,    19,   195,   173,    77,   238,   187,   146,   129,   104,    57,
                            13,    19,   202,   246,    32,    55,   175,   194,    84,   100,    95,    98,    36,   141,   180,    87,   165,    72,   115,   226,   252,   205,   104,   226,   112,     3,    49,    92,    32,    70,    29,     1,
                           171,    23,    94,   111,    34,    20,    76,   189,   140,   209,   215,   158,    56,   149,   187,    54,   213,    59,   246,    25,   183,   229,   171,    73,   112,   138,    66,   116,   172,    26,   114,    49,
                           154,   204,    53,   178,    24,   234,   136,   190,   102,    81,   188,   147,    47,   131,    58,   131,   102,   182,    11,   238,   214,   153,   239,   172,    30,    25,   229,    99,   153,   130,    77,    37,
                           135,   241,    23,   194,     2,   181,   213,    28,   106,   208,   146,   136,    11,    22,    69,   232,   192,   160,   249,   102,   111,   226,   207,   170,   208,    38,   152,   198,    15,   150,   103,    69,
                           187,   175,   197,   111,   108,   143,   153,   174,    47,   202,    46,    71,    28,   184,   172,   161,   213,   151,    49,    13,   121,   241,   124,    32,    83,   161,   129,   188,    15,   195,   213,    45,
                           181,    34,    53,   168,   168,    80,    86,   119,    66,   218,   245,    64,   158,   255,   122,    26,    83,   169,   171,    88,   143,   141,   193,   104,    63,   220,   157,   110,    39,    22,   103,    36,
                           200,   185,   100,    28,   185,    43,    77,    55,     6,   129,    68,   116,   240,    91,   160,   100,   141,    13,   150,   188,    69,   186,   107,    71,    88,   249,   209,   177,     6,   169,   100,   153,
                            74,    29,   141,   239,   136,   159,   116,    26,   236,   163,   236,    59,    91,   248,    61,    14,   250,    89,   173,   203,   191,   148,   248,   183,    96,   146,   136,   242,   111,   132,    92,   230,
                           177,    30,    59,    48,    28,   252,   108,   211,   167,   243,    58,   206,   105,    89,    46,   128,   141,   116,    93,   139,   129,     7,   252,    73,   140,   255,    52,   200,   213,    44,    36,   240,
                           142,   164,   164,    68,   162,    44,    92,    45,   238,   114,    96,   252,   252,   227,   212,   111,    85,    62,   159,   175,   165,   114,   221,   229,   144,   142,   116,   180,   158,   240,    67,    57,
                           102,    84,   124,   204,    33,    66,   143,    42,    42,    16,    23,     8,   242,   116,   196,   255,   158,   183,   207,   228,    79,   165,   100,   211,   101,   132,   110,    28,   133,   151,    23,   124,
                            16,   167,    39,   125,    35,   102,   190,   170,   235,   222,   164,   137,   173,   106,   239,   207,    92,   219,     5,    14,    36,   133,   116,   100,   102,    85,   247,   100,   221,   113,   110,    96,
                           199,   192,   200,   197,    26,    19,   109,   229,   203,   161,    47,    23,   253,    56,    28,   124,   193,    72,    22,    78,   122,    95,    63,   127,   132,   110,   159,   151,    25,   241,    66,   134,
                            87,   149,    26,   101,    37,   175,   110,   132,   148,    91,    12,   205,   196,    33,    47,   229,   106,   187,   249,    12,    93,   239,   201,   178,   168,   126,   178,   118,   232,   168,    76,    68,
                           156,   189,    75,    70,    43,   103,    32,   180,   113,   255,   185,   253,    86,    79,    26,    36,   126,    36,   167,    50,   201,   212,   226,   213,   243,    19,   184,    13,    28,   116,   109,    18,
                           190,    60,    61,    10,    51,   251,     7,    40,    66,    58,    89,    18,   169,   186,   125,   100,   178,   214,    59,   184,   199,   217,   233,   156,   185,   227,    89,    59,   132,   215,    31,   112,
                            27,   188,   136,   172,    81,   103,    74,   244,   192,   167,   169,   240,    63,   200,    50,   237,   249,    36,   103,   185,   171,    95,   143,   147,   103,    17,   132,   213,    37,   136,   127,    45,
                            33,   248,    24,   110,    81,   159,    81,   138,    59,   155,    98,     5,    76,   177,   229,   234,    84,   150,    32,   224,    35,   152,   153,    84,   213,   112,   142,     4,   143,   142,   181,     7,
                           141,   222,   104,   116,    56,    40,   167,   174,    17,    99,   160,   175,   174,     3,    26,   182,   214,    94,    69,   149,     6,   223,    38,   117,    35,   211,    40,   221,     2,   174,    63,   244,
                           124,    22,    27,   156,    65,    98,   245,    10,   196,    37,     6,   200,   135,   216,    12,   158,   189,   206,    66,    19,   143,   239,   230,   183,    16,   101,   144,    20,   196,    94,   201,   110};

Rox_Float If_grt_data[24*32] = {  117.9489059448242188, 124.1039352416992188, 117.5621871948242188, 108.9322357177734375, 112.8391189575195312, 128.5381927490234375, 145.6126708984375000, 156.6967010498046875, 157.2852935791015625, 149.7230072021484375, 145.9700469970703125, 151.5095214843750000, 158.1162567138671875, 159.6647338867187500, 157.0499114990234375, 151.7133026123046875, 146.0033264160156250, 141.2458190917968750, 137.7265167236328125, 138.4420166015625000, 142.6303558349609375, 143.8450164794921875, 140.5389709472656250, 135.8291931152343750, 131.5428161621093750, 132.0373077392578125, 141.2557525634765625, 153.2094726562500000, 156.2465820312500000, 141.5993499755859375, 109.8464813232421875,  74.5517578125000000,
                                  116.5172729492187500, 125.1460723876953125, 125.3818130493164062, 122.2602462768554688, 125.0671691894531250, 134.3743133544921875, 143.6546936035156250, 148.3024749755859375, 147.4532623291015625, 144.5117645263671875, 146.7262725830078125, 154.9980316162109375, 160.2155456542968750, 156.9050750732421875, 148.8240509033203125, 140.9147644042968750, 135.1589050292968750, 131.2405548095703125, 129.4905090332031250, 132.6917266845703125, 139.6677246093750000, 143.0438537597656250, 139.6818695068359375, 133.3635559082031250, 128.7884979248046875, 131.0929718017578125, 141.1367797851562500, 151.2506256103515625, 153.2060241699218750, 141.4188537597656250, 114.2113265991210938,  81.1985168457031250,
                                  106.8810501098632812, 118.7202606201171875, 126.8045196533203125, 129.3253784179687500, 130.3562164306640625, 133.6830139160156250, 137.8067779541015625, 139.1925506591796875, 138.0043640136718750, 138.4393005371093750, 144.2250976562500000, 152.6595306396484375, 155.2855377197265625, 148.2402496337890625, 136.8981170654296875, 128.6012115478515625, 125.3200759887695312, 124.5924453735351562, 125.5050277709960938, 130.3531646728515625, 138.2702178955078125, 142.6622009277343750, 139.9771423339843750, 133.0982513427734375, 127.3369827270507812, 128.9121856689453125, 137.6585083007812500, 144.7193450927734375, 143.7855072021484375, 132.3105926513671875, 108.3496551513671875,  78.3823623657226562,
                                   94.0634613037109375, 107.6728515625000000, 121.0265579223632812, 126.6514816284179688, 125.4982681274414062, 125.7885971069335938, 130.2624816894531250, 133.7612152099609375, 134.1689300537109375, 135.5477905273437500, 140.1029052734375000, 144.3779754638671875, 143.5964965820312500, 136.7612457275390625, 127.7834548950195312, 122.4022445678710938, 122.2713470458984375, 124.5192947387695312, 128.0920715332031250, 134.7594451904296875, 142.8636474609375000, 146.4341888427734375, 142.8258361816406250, 134.2974395751953125, 125.4108657836914062, 122.9802551269531250, 127.8587417602539062, 131.4383239746093750, 127.3682861328125000, 114.6684417724609375,  93.1863174438476562,  67.9105606079101562,
                                   93.5672760009765625, 103.5329055786132812, 114.7210388183593750, 118.6977462768554688, 116.0273895263671875, 117.0525665283203125, 125.2011184692382812, 132.8795928955078125, 135.7214965820312500, 136.8724060058593750, 137.3483276367187500, 134.7991943359375000, 130.1398162841796875, 126.1462402343750000, 123.5568695068359375, 123.2596817016601562, 125.6114120483398438, 129.1811523437500000, 134.6443481445312500, 143.6793823242187500, 152.9705505371093750, 155.6408233642578125, 149.1437988281250000, 136.2513427734375000, 122.4772949218750000, 115.3511810302734375, 116.4835891723632812, 117.7940826416015625, 112.1511917114257812,  98.8379898071289062,  79.7045288085937500,  59.3194122314453125,
                                  110.4512481689453125, 112.1716995239257812, 114.5121612548828125, 113.3948059082031250, 110.8565750122070312, 114.7471313476562500, 125.1151580810546875, 133.8287200927734375, 137.6759338378906250, 138.8360900878906250, 135.8721923828125000, 127.1627502441406250, 118.7092132568359375, 117.1329574584960938, 121.2208557128906250, 126.8863525390625000, 131.7624206542968750, 135.3484344482421875, 140.5499572753906250, 150.2945556640625000, 161.1274261474609375, 164.6982879638671875, 156.3361816406250000, 139.0837860107421875, 121.4673614501953125, 112.3947982788085938, 112.4964675903320312, 113.1003875732421875, 107.1554031372070312,  94.3513336181640625,  77.1193923950195312,  59.5350952148437500,
                                  132.7797393798828125, 127.2878875732421875, 120.7843627929687500, 114.9356765747070312, 113.3892440795898438, 119.1607971191406250, 127.8958053588867188, 133.3191223144531250, 136.0344543457031250, 137.3674926757812500, 132.7315521240234375, 120.7482833862304688, 110.5858688354492188, 111.1129531860351562, 120.4836044311523438, 131.4375000000000000, 138.5261993408203125, 140.7310943603515625, 142.6096191406250000, 149.7821197509765625, 160.9468841552734375, 166.8139953613281250, 159.4657135009765625, 141.4148712158203125, 123.8915252685546875, 116.3823318481445312, 117.1751403808593750, 116.8116912841796875, 110.3680496215820312,  98.9885711669921875,  83.7140884399414062,  66.9978332519531250,
                                  148.3631134033203125, 138.9172363281250000, 127.9769668579101562, 120.1674575805664062, 118.8707809448242188, 123.3979873657226562, 127.8880996704101562, 129.1982269287109375, 130.9285125732421875, 132.9731140136718750, 128.4466705322265625, 117.0145111083984375, 109.1009902954101562, 112.3330535888671875, 123.6220550537109375, 135.5515441894531250, 142.2879028320312500, 142.0756225585937500, 139.6193084716796875, 142.7834930419921875, 152.9721221923828125, 160.6099700927734375, 155.5132598876953125, 140.2577362060546875, 127.2766189575195312, 123.9283142089843750, 125.0027618408203125, 121.6459503173828125, 113.4684524536132812, 104.0769195556640625,  91.9110870361328125,  76.4268646240234375,
                                  153.7195281982421875, 141.7156219482421875, 130.1439666748046875, 123.2620544433593750, 121.4619903564453125, 122.1463851928710938, 121.9245910644531250, 121.3811874389648438, 124.5969848632812500, 129.1643981933593750, 127.2189712524414062, 119.9148788452148438, 116.8300781250000000, 121.2577819824218750, 128.5972900390625000, 135.1119079589843750, 138.6821441650390625, 137.4565124511718750, 133.9859161376953125, 135.2852020263671875, 143.8466491699218750, 151.1118011474609375, 147.3129119873046875, 136.1901397705078125, 130.1077575683593750, 132.1951904296875000, 132.9375457763671875, 125.0601196289062500, 113.7216186523437500, 105.7607803344726562,  98.0556411743164062,  86.7734985351562500,
                                  149.8253021240234375, 136.4604187011718750, 126.5024337768554688, 122.4300079345703125, 120.6925811767578125, 117.6522903442382812, 113.8959350585937500, 113.7068176269531250, 120.2003860473632812, 128.4102783203125000, 130.3837585449218750, 128.0821838378906250, 128.5538330078125000, 130.7417297363281250, 130.3399047851562500, 129.1999969482421875, 129.9014282226562500, 130.7401275634765625, 131.0311584472656250, 133.7821960449218750, 140.4371185302734375, 145.4277038574218750, 142.0664672851562500, 134.7101745605468750, 134.3255157470703125, 140.6463928222656250, 141.2979888916015625, 130.1092071533203125, 115.7066574096679688, 108.0649642944335938, 105.5948410034179688, 102.5803146362304688,
                                  139.6510009765625000, 127.2628173828125000, 120.2888946533203125, 119.5817642211914062, 119.3944931030273438, 115.7064590454101562, 111.4499206542968750, 113.0412445068359375, 122.2382736206054688, 132.1642761230468750, 135.9039459228515625, 135.9912872314453125, 136.7277526855468750, 134.9263305664062500, 128.4533691406250000, 123.1211166381835938, 123.3900680541992188, 127.3958663940429688, 132.5569915771484375, 137.8027191162109375, 142.7593231201171875, 145.6995849609375000, 143.5368194580078125, 139.1405181884765625, 140.7627868652343750, 147.7360076904296875, 148.7741546630859375, 138.1029510498046875, 123.2961502075195312, 115.4568939208984375, 117.3553085327148438, 124.0108566284179688,
                                  129.0563812255859375, 118.9177398681640625, 114.4539337158203125, 115.7641983032226562, 117.6680374145507812, 116.7024383544921875, 115.5531692504882812, 119.9518127441406250, 129.9377441406250000, 138.3162384033203125, 141.0441589355468750, 141.6359863281250000, 141.7464599609375000, 137.4275512695312500, 128.7811737060546875, 122.7190551757812500, 123.0953826904296875, 128.1599273681640625, 135.3355865478515625, 141.4699554443359375, 145.1561889648437500, 147.7830505371093750, 148.4053497314453125, 146.5474395751953125, 146.9402618408203125, 150.8790740966796875, 151.8921661376953125, 144.9921417236328125, 133.0326690673828125, 124.7527008056640625, 127.3834457397460938, 139.3318328857421875,
                                  122.5919570922851562, 115.0495300292968750, 111.3853988647460938, 111.6779708862304688, 113.4402847290039062, 115.1865844726562500, 118.2142333984375000, 125.1239089965820312, 133.9672851562500000, 139.2952117919921875, 141.4604339599609375, 144.8448028564453125, 147.7433929443359375, 144.8242492675781250, 137.0280303955078125, 130.5275726318359375, 128.6867065429687500, 131.3274536132812500, 136.8027954101562500, 141.3414764404296875, 143.6612854003906250, 146.9930114746093750, 150.8510284423828125, 151.2394409179687500, 149.4762420654296875, 148.9929199218750000, 148.9186706542968750, 146.0402069091796875, 138.3679809570312500, 129.5639953613281250, 128.3353271484375000, 137.6474456787109375,
                                  118.2747879028320312, 114.8935317993164062, 111.9059448242187500, 109.1283950805664062, 107.6978454589843750, 109.8402938842773438, 115.9925231933593750, 124.3604583740234375, 130.8756713867187500, 132.9524993896484375, 135.4046478271484375, 143.3706512451171875, 152.1264495849609375, 154.2798004150390625, 149.9853515625000000, 143.5175933837890625, 137.9548034667968750, 135.3983459472656250, 135.8189392089843750, 136.4860534667968750, 137.2171325683593750, 141.2785644531250000, 147.2338714599609375, 149.1420898437500000, 146.3310699462890625, 143.1865997314453125, 142.1213073730468750, 141.6495361328125000, 137.6005249023437500, 128.8575592041015625, 122.2758789062500000, 124.2370605468750000,
                                  114.7833557128906250, 116.1326141357421875, 114.1381301879882812, 108.2293472290039062, 103.1628952026367188, 105.4585723876953125, 115.1550598144531250, 125.6596145629882812, 130.2702484130859375, 128.5730133056640625, 128.8241119384765625, 137.5504760742187500, 149.1999053955078125, 155.4862976074218750, 155.7894592285156250, 151.8777313232421875, 144.5700683593750000, 136.3195343017578125, 129.6002960205078125, 125.5570144653320312, 125.8540649414062500, 131.4167327880859375, 138.5028533935546875, 141.3482055664062500, 139.4544067382812500, 137.0265350341796875, 136.5472869873046875, 136.9982147216796875, 134.7063446044921875, 126.6053161621093750, 116.7611389160156250, 112.5798950195312500,
                                  116.6128997802734375, 119.3864822387695312, 116.1795654296875000, 107.2367630004882812, 100.1902770996093750, 104.0932998657226562, 118.2569503784179688, 132.2582702636718750, 136.6171264648437500, 131.5600585937500000, 127.3943939208984375, 131.8942108154296875, 139.9747314453125000, 144.6476287841796875, 147.0194702148437500, 147.4991302490234375, 142.4803466796875000, 131.6835174560546875, 119.8293151855468750, 113.3601226806640625, 115.8975677490234375, 124.6793975830078125, 132.9564208984375000, 136.2272338867187500, 135.5365905761718750, 134.7073669433593750, 135.0570983886718750, 135.2850952148437500, 133.0851593017578125, 125.4958877563476562, 114.4073104858398438, 106.6974029541015625,
                                  123.6362380981445312, 122.9933776855468750, 115.5430603027343750, 103.9809875488281250,  97.1072158813476562, 102.8799285888671875, 119.3233566284179688, 135.3559265136718750, 140.8016357421875000, 135.5454864501953125, 129.5509338378906250, 129.6230773925781250, 130.7327270507812500, 128.9226531982421875, 129.5630493164062500, 133.8671722412109375, 134.2535400390625000, 126.4139785766601562, 115.3573684692382812, 110.8795928955078125, 117.9364700317382812, 130.8610992431640625, 140.2562713623046875, 142.4176483154296875, 139.8706512451171875, 136.8428802490234375, 134.9111328125000000, 133.3372955322265625, 130.6123962402343750, 123.3346481323242188, 111.3078613281250000, 100.7078399658203125,
                                  128.6495208740234375, 122.5335617065429688, 110.4170837402343750,  98.0306701660156250,  93.4029235839843750, 100.1955947875976562, 114.9314270019531250, 129.6483612060546875, 136.7962341308593750, 135.4372863769531250, 132.1290130615234375, 130.5495758056640625, 126.1490097045898438, 118.4805755615234375, 116.2814559936523438, 122.2373580932617188, 127.5423889160156250, 125.4496841430664062, 119.8600845336914062, 120.7032546997070312, 132.6457061767578125, 148.5680541992187500, 157.8622131347656250, 157.0207672119140625, 149.2790832519531250, 139.8173675537109375, 132.1022491455078125, 127.2708358764648438, 124.1429824829101562, 117.6230010986328125, 104.9816589355468750,  91.7503051757812500,
                                  127.0378265380859375, 118.2973098754882812, 104.6332855224609375,  93.5973510742187500,  91.7340240478515625,  98.4353027343750000, 109.3794631958007812, 120.9372482299804688, 129.2949371337890625, 132.5565185546875000, 132.9779663085937500, 131.7130126953125000, 126.2615432739257812, 118.2835311889648438, 115.8135604858398438, 121.4574737548828125, 127.5850219726562500, 128.2214050292968750, 127.4287033081054688, 133.4129943847656250, 148.0553131103515625, 163.6220550537109375, 170.7413940429687500, 166.6162414550781250, 154.3881683349609375, 139.4567871093750000, 126.7741165161132812, 119.3369064331054688, 116.3737106323242188, 111.3238296508789062,  99.2010269165039062,  84.6472625732421875,
                                  119.2153320312500000, 114.0452651977539062, 103.5927352905273438,  95.0991058349609375,  94.5780715942382812, 100.3130569458007812, 108.2497329711914062, 116.9076614379882812, 124.5259094238281250, 129.1206665039062500, 130.8240051269531250, 130.3738861083984375, 127.8867568969726562, 125.1995086669921875, 126.3786392211914062, 131.5005340576171875, 134.2228393554687500, 131.9615173339843750, 131.4244232177734375, 138.9419860839843750, 152.3552398681640625, 164.0692901611328125, 167.7711029052734375, 162.0158386230468750, 149.4027709960937500, 134.3879699707031250, 121.6120223999023438, 114.4458236694335938, 112.5272216796875000, 109.2897186279296875,  98.6814498901367188,  84.2029800415039062,
                                  110.3819580078125000, 111.9330673217773438, 106.5696487426757812, 100.2018432617187500,  99.5271377563476562, 104.4572296142578125, 111.3273391723632812, 117.6991653442382812, 122.3618240356445312, 125.0775527954101562, 126.3102264404296875, 126.8236846923828125, 127.9152221679687500, 131.1296386718750000, 137.2495269775390625, 142.9392242431640625, 141.5457763671875000, 133.7145996093750000, 129.4620208740234375, 134.5225524902343750, 144.4577636718750000, 152.1774291992187500, 153.3729705810546875, 147.6546630859375000, 137.6568450927734375, 126.6718215942382812, 117.6091156005859375, 112.9545516967773438, 112.8686218261718750, 112.0432815551757812, 104.3426361083984375,  91.7630691528320312,
                                  106.7973022460937500, 110.6908340454101562, 107.6896286010742188, 102.6599502563476562, 102.2635650634765625, 107.6941223144531250, 114.5628738403320312, 118.1371383666992188, 118.2700424194335938, 118.2894439697265625, 120.1759414672851562, 123.1799011230468750, 126.4772796630859375, 131.3694610595703125, 139.4627075195312500, 146.6942749023437500, 144.5015411376953125, 133.0116577148437500, 123.7968292236328125, 124.9202423095703125, 133.3036804199218750, 140.9307098388671875, 141.5569458007812500, 135.1214904785156250, 126.4788055419921875, 119.2170257568359375, 114.1260223388671875, 112.3276672363281250, 114.6690292358398438, 117.4281768798828125, 114.8185806274414062, 107.0302505493164062,
                                  106.6867523193359375, 106.0590972900390625, 102.6616363525390625, 100.2118911743164062, 102.5654449462890625, 110.0467987060546875, 116.8553619384765625, 116.7849197387695312, 111.7288436889648438, 109.0821914672851562, 113.2973785400390625, 121.3235244750976562, 126.7531738281250000, 129.2963409423828125, 134.9992370605468750, 143.6136932373046875, 144.4508819580078125, 132.6031951904296875, 118.9864120483398438, 117.2145690917968750, 128.3543548583984375, 140.7715148925781250, 142.0439453125000000, 131.7252349853515625, 119.6872558593750000, 112.8173294067382812, 110.4399795532226562, 111.5955886840820312, 116.9867553710937500, 123.7077407836914062, 126.3919296264648438, 123.8553390502929688,
                                  103.8887634277343750,  96.4240188598632812,  92.9760742187500000,  95.4832611083984375, 102.8392028808593750, 113.0552062988281250, 119.4421234130859375, 115.9199829101562500, 106.2761001586914062, 100.7350921630859375, 106.9662094116210938, 120.9725341796875000, 129.9410705566406250, 129.9998016357421875, 131.4644775390625000, 140.1816406250000000, 144.7626953125000000, 134.0473480224609375, 117.2615280151367188, 114.4172973632812500, 131.0673065185546875, 150.5799865722656250, 152.8398590087890625, 136.3760833740234375, 117.0797882080078125, 107.4141998291015625, 106.5121307373046875, 110.8309249877929688, 119.5856399536132812, 129.1999816894531250, 134.1826477050781250, 133.0135192871093750};

//=== INTERNAL TYPESDEFS =======================================================

//=== INTERNAL DATATYPES =======================================================

//=== INTERNAL VARIABLES =======================================================

//=== INTERNAL FUNCTDEFS =======================================================

//=== INTERNAL FUNCTIONS =======================================================

//=== EXPORTED FUNCTIONS =======================================================

ROX_TEST_CASE_DECLARE(rox::OpenROXTest, test_array2d_float_symmetric_seperable_convolve)
{
   Rox_ErrorCode error = ROX_ERROR_NONE;
   Rox_Float sigma = 1.5;
   Rox_Sint cols = 32, rows = 24;
   Rox_Float l2_error = 0.0;

   Rox_Array2D_Float Ir = NULL;
   error = rox_array2d_float_new ( &Ir, rows, cols );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   error = rox_array2d_float_set_buffer_no_stride(Ir, Ir_data);
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float If = NULL;
   error = rox_array2d_float_new ( &If, rows, cols );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float If_grt = NULL;
   error = rox_array2d_float_new ( &If_grt, rows, cols );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   error = rox_array2d_float_set_buffer_no_stride ( If_grt, If_grt_data );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float hfilter = NULL;
   Rox_Array2D_Float vfilter = NULL;
   
   error = rox_kernelgen_gaussian2d_separable_float_new ( &hfilter, &vfilter, sigma, 3 * sigma);
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float kernel = hfilter;

   error = rox_array2d_float_symmetric_seperable_convolve ( If, Ir, kernel );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   error = rox_array2d_float_difference_l2_norm ( &l2_error, If_grt, If );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   rox_log("l2_error If = %f \n", l2_error);

   ROX_TEST_CHECK_CLOSE (l2_error, 0.0, 1e-12);

   //rox_array2d_float_print(kernel);
   //rox_array2d_float_print(If);
}

ROX_TEST_CASE_DECLARE ( rox::OpenROXTest, test_array2d_float_symmetric_seperable_convolve_perf )
{
	Rox_ErrorCode error = ROX_ERROR_NONE;
   Rox_Float sigma = 1.5;

   Rox_Image Ir_uchar = NULL;
   error = rox_image_new_read_pgm ( &Ir_uchar, IMG_REF_PATH );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );
   
   Rox_Sint cols = 0, rows = 0;
   error = rox_image_get_size ( &rows, &cols, Ir_uchar );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float Ir = NULL;
   error = rox_array2d_float_new ( &Ir, rows, cols );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float If = NULL;
   error = rox_array2d_float_new ( &If, rows, cols );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float hfilter = NULL;
   Rox_Array2D_Float vfilter = NULL;
   
   error = rox_kernelgen_gaussian2d_separable_float_new ( &hfilter, &vfilter, sigma, 3 * sigma);
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   Rox_Array2D_Float kernel = hfilter;

   error = rox_array2d_float_symmetric_seperable_convolve ( If, Ir, kernel );
   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );

   rox_array2d_float_print(kernel);
}

ROX_TEST_CASE_DECLARE(rox::OpenROXTest, test_array2d_uchar_symmetric_seperable_convolve)
{
	Rox_ErrorCode error = ROX_ERROR_NONE;

	ROX_TEST_MESSAGE ( "This test has not been implemented yet !!! \n" );

   ROX_TEST_CHECK_EQUAL ( error, ROX_ERROR_NONE );
}

ROX_TEST_SUITE_END()
